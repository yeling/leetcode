/*
* auther yeling
* 1383. 最大的团队表现值
* 
*/
/**
 * @param {number} n
 * @param {number[]} speed
 * @param {number[]} efficiency
 * @param {number} k
 * @return {number}
 */
//TLE  23 / 55 个通过测试用例
let MOD = 10 ** 9 + 7;
var maxPerformance2 = function (n, speed, efficiency, k) {
    //回朔
    let maxSum = 0;
    let minEffi = 0;
    let res = 0;
    let dfs = (index, used, len, dst) => {
        if (len == dst) {
            let sum = 0;
            let effi = Number.MAX_SAFE_INTEGER;
            for (let i = 0; i < n; i++) {
                if (used[i] == true) {
                    sum += speed[i];
                    if (effi > efficiency[i]) {
                        effi = efficiency[i];
                    }
                }
            }
            if (sum * effi > maxSum * minEffi) {
                maxSum = sum;
                minEffi = effi;
            }
            console.log(used);
            console.log(`${sum} ${effi}`);
            return;
        }
        if (index >= n) {
            return;
        }
        used[index] = true;
        dfs(index + 1, used, len + 1, dst);
        used[index] = false;

        dfs(index + 1, used, len, dst);
    }
    let used = new Array(n).fill(false);

    for (let i = 1; i <= k; i++) {
        dfs(0, used, 0, i);
    }
    return (maxSum * minEffi) % MOD;
};

//dp 45 / 55
var maxPerformance = function (n, speed, efficiency, k) {
    let dp = new Array(k + 1).fill(0).map(() => [0, Number.MAX_SAFE_INTEGER, 0]);
    let used = new Array(n).fill(false);
    let res = [0, Number.MAX_SAFE_INTEGER];

    for (let i = 1; i <= k; i++) {
        let last = dp[i - 1];
        let maxSum = 0;
        let minEffi = 0;
        let addPos = 0;
        for (let j = 0; j < n; j++) {
            if (used[j] == false) {
                if ((maxSum * minEffi) < ((last[0] + speed[j]) * Math.min(last[1], efficiency[j]))) {
                    maxSum = last[0] + speed[j];
                    minEffi = Math.min(last[1], efficiency[j]);
                    addPos = j;
                }
            }
        }
        dp[i] = [maxSum, minEffi];
        used[addPos] = true;
        // console.log(`add ${addPos} ${dp[i][0] * dp[i][1]}`);
        // console.log(dp.join('\n'));
        if ((maxSum * minEffi) > (res[0] * res[1])) {
            res = [maxSum, minEffi];
        }
    }
    return (res[0] * res[1]) % MOD;
}

n = 3, speed = [2, 10, 3], efficiency = [5, 4, 3], k = 2

n = 7
speed = [1, 4, 1, 9, 4, 4, 4]
efficiency = [8, 2, 1, 7, 1, 8, 4]
k = 6

n = 24
speed = [29810, 40211, 42893, 41516, 39690, 43822, 71333, 75889, 12065, 28857, 31951, 9481, 72248, 95574, 2820, 1300, 98400, 64653, 20209, 65724, 10107, 87196, 23537, 18552, 40059, 92973, 78892, 16555, 18571, 94717, 41428, 88107, 97804, 26927, 39181, 70451, 6365, 87528, 33108, 89402, 56384, 32797, 57593, 59417, 51867, 22482, 63673, 84731, 74791, 8169, 46524, 18126, 16401, 33963, 52141, 52571, 80275, 30610, 981, 69298, 65654, 57452, 83770, 29587, 41024, 90040, 29500, 54034, 73454, 95450, 36075, 28767, 9379, 84580, 20902, 26719, 39154, 39265, 48709, 91919, 96524, 77933, 16154, 67365, 49441, 20419, 55936, 74648, 99320, 64885, 51591, 83490, 50329, 21601, 95669, 68705, 33448, 13245, 96588, 18236, 86471, 91804, 58335, 50116, 52068, 42660, 16559, 63959, 15623, 78733, 53507, 86575, 36396, 49657, 526, 69254, 75902, 4039, 79381, 34131, 22657, 19453, 26274, 40782, 99277, 89592, 22018, 46787, 55046, 27387, 50235, 37231, 3166, 74621, 71472, 88332, 85117, 9855, 48986, 40797, 65934, 46769, 42427, 16240, 94106, 45904, 70687, 44482, 89577, 64527, 84892, 50121, 72993, 36389, 78403, 96806, 66973, 60501, 67753, 97601, 40022, 22324, 81270, 69594, 47111, 462, 51009, 55820, 44042, 76603, 91686, 64580, 83933, 38128, 2724, 94541, 20459, 52078, 23351, 79360, 45804, 92802, 89789, 39803, 60565, 63511, 61225, 5950, 66884, 97616, 55391, 46554, 86094, 2588, 66475, 21185, 12197, 83359, 36150, 39899, 69219, 31095, 35268, 9816, 68577, 48262, 67046, 96565, 22093, 85599, 93512, 35359, 79911, 30424, 73538, 22592, 34017, 43208, 29140, 79948, 32012, 4003, 52770, 56593, 35271, 9508, 95988, 75910, 76210, 19423, 34339, 69022, 18170, 93815, 47329, 98485, 31522, 94131, 94173, 40042, 13945, 52037, 64535, 24480, 7254, 3052, 89562, 64810, 69277, 80371, 44885, 35990, 80379, 22635, 29107, 30569, 58959, 98385, 30372, 37178, 71699, 51065, 59205, 33801, 65056, 14542, 10336, 2021, 62967, 50220, 37646, 52420, 99427, 19959, 1990, 19029, 71117, 74023, 33315, 10423, 85480, 1893, 70384, 68801, 5612, 15393, 11933, 3621, 83561, 97599, 90017, 86903, 51080, 82715, 34059, 83311, 32169, 77061, 22974, 56161, 91496, 83674, 7970, 71687, 70530, 93278, 55591, 9187, 35009, 80041, 98594, 32976, 12658, 7696, 56113, 6923, 11957, 61495, 48530, 40985, 16598, 4350, 87066, 51799, 58470, 96551, 35389, 32770, 11245, 4482, 7624, 34211, 96367, 34119, 15354, 39813, 55684, 65896, 26924, 44390, 51262, 63066, 17004, 58801, 73223, 76201, 68168, 3968, 97410, 26212, 51019, 42497, 53675, 16564, 8502, 39387, 69951, 54735, 41786, 35740, 98139, 65675, 68961, 19498, 95264, 42935, 9024, 36650, 59526, 97208, 10246, 7354, 6387, 64511, 33020, 92133, 97865, 47393, 48515, 40290, 78416, 69748, 21994, 19446, 90079, 73765, 14780, 53885, 81226, 13006, 89302, 93672, 26784, 8753, 74871, 84022, 9544, 84311, 67041, 2864, 48249, 93098, 28828, 78392, 30831, 59270, 48125, 24750, 95135, 33628, 26394, 97883, 49902, 63843, 52920, 66856, 76625, 5259, 60091, 24873, 91226, 84159, 70881, 39670, 97893, 71176, 74970, 37029, 53928, 67878, 79007, 76161, 59313, 17164, 58220, 18393, 21361, 83449, 55598, 86711, 4752, 55165, 36904, 98437, 2403, 11801, 50256]
efficiency = [52409144, 5509941, 25073597, 77712955, 32997178, 13548961, 82059612, 79988739, 32896498, 2734556, 53925148, 35978917, 9518234, 10083751, 85279542, 39033408, 48209851, 62925888, 13547194, 44035972, 68353067, 23252163, 20073998, 42920683, 14344887, 69035996, 39391494, 27748248, 73214826, 4262748, 83688455, 74215897, 92555899, 23911542, 58067690, 21192570, 95942114, 33191627, 8645527, 59954387, 73721763, 72662479, 72217179, 1458481, 45455404, 34624026, 3276054, 55926364, 2538189, 92838862, 77855755, 79664441, 18588592, 37166813, 75708455, 23108833, 11978561, 65229374, 23834131, 42579452, 87085776, 92142233, 98169793, 31994108, 66447473, 64267057, 95676586, 45224865, 82045517, 87698900, 86760377, 6468938, 68678099, 49484751, 68670060, 41849361, 92953423, 74130846, 22169912, 94123667, 62381496, 11404911, 81350059, 76669555, 23659351, 33634347, 29208286, 96582765, 6997203, 91487697, 96254682, 46705288, 69129620, 73044360, 5463828, 12133523, 84348931, 35906765, 11236700, 82799272, 92157812, 11006966, 32345170, 58105753, 22112937, 58804673, 83537456, 28456190, 57882805, 71679588, 15849776, 39658053, 33315038, 75077925, 25479720, 58891125, 2823227, 84225193, 32512794, 27730164, 38222742, 72791567, 36671733, 78616435, 33672843, 59914327, 73199263, 65875307, 16347721, 76577204, 27490709, 14514199, 15847293, 1773821, 39783827, 97216020, 18333339, 67158723, 76850157, 58675855, 90900690, 70919839, 113377, 59366425, 60337868, 40909455, 53606930, 98131095, 76694029, 15179404, 50675006, 27368881, 520182, 85299790, 96943869, 97761582, 26693124, 80642358, 54890399, 95580346, 94340555, 60315856, 89770242, 26489362, 70624121, 91073195, 77758531, 54392013, 83433073, 98493102, 9092678, 33236521, 87073139, 84513597, 54626478, 84458121, 85058138, 36273509, 9853306, 1359367, 35511764, 55182268, 73047564, 20410486, 34809483, 22766268, 68494858, 36348909, 13237907, 79273853, 9362263, 8992441, 59389134, 22030332, 95327344, 92670308, 53945290, 92463699, 81200910, 28036660, 27878141, 44821397, 9201186, 93844369, 88420620, 62805392, 74846641, 6676310, 39846057, 98661632, 74657575, 47761591, 99300303, 52688395, 53648926, 64910915, 81926714, 96106913, 34731191, 94850369, 88696471, 83544102, 42483824, 33343240, 25488064, 84005065, 22230419, 59535838, 97743772, 81370827, 61658488, 21815186, 18535199, 59147254, 41575534, 53788561, 15547373, 27674242, 91455784, 9157169, 30550600, 43133574, 13418312, 6037203, 80196915, 29065895, 4659159, 94479026, 97168531, 59362807, 88976311, 15846699, 92964157, 12781669, 53647598, 66440847, 50720111, 22628784, 31640052, 62085874, 77837256, 28441679, 95956960, 44307589, 79674139, 28702153, 6203269, 701612, 42892555, 77880342, 26291144, 21483953, 86710609, 4087842, 51978739, 89229451, 7666475, 50934271, 17445468, 62127947, 40721868, 4760655, 8167385, 17304056, 36720664, 58050499, 25516258, 67063506, 17490145, 37483093, 25759943, 60064361, 44265676, 35966750, 86114542, 32627221, 8077773, 79254965, 46924497, 81249071, 75196502, 70084709, 47409400, 55384949, 26758766, 71995043, 88903900, 95770584, 99761764, 96786456, 9701824, 23834179, 20268187, 27292708, 6027141, 85513177, 68832164, 67260236, 13325421, 5384539, 71332033, 59505400, 17207132, 94978827, 3304402, 70398482, 12130142, 43676345, 40512228, 51571311, 98328737, 42037891, 17448963, 51027324, 90971680, 12624314, 32935688, 74783098, 44306234, 68359791, 78401987, 14050977, 87587125, 70296049, 96553750, 94125049, 71889567, 39101099, 21076465, 49707787, 69937862, 13070135, 46356024, 77162533, 5848487, 87391451, 42097414, 40039965, 47327338, 43659510, 69806991, 1155797, 16356308, 42561888, 43697659, 76921522, 60641417, 64383955, 48877454, 51073567, 77707695, 18063186, 70291398, 77256263, 32932323, 77011969, 45452682, 86369228, 54032650, 62353742, 45694651, 68121148, 3902022, 33571278, 29679847, 17905659, 24776639, 97705167, 6724984, 73243675, 35665572, 14352922, 35124454, 84844541, 70649184, 10535657, 29176348, 23268960, 57994116, 79236664, 65320138, 38084604, 26895286, 66251930, 57102138, 90677543, 73078374, 64714177, 9756702, 54668275, 1111304, 71402264, 69026003, 10255970, 82657264, 77615576, 57122680, 47221323, 859161, 40178651, 92789343, 739148, 16112120, 68785506, 42352675, 86576855, 74004543, 70548491, 72751454, 54801202, 84552504, 41306769, 40521727, 67956765, 78687514, 73819008, 33922695, 1289271, 98802406, 75954956, 49440866, 53974168, 88448415, 89882431, 12143598, 646710, 36087820]
k = 10

n = 23
speed = [48842, 98221, 44112, 59789, 63403, 18966, 19433, 22555, 48204, 77278, 54122, 67344, 96931, 90613, 56821, 63675, 93778, 52679, 55722, 8447, 27020, 30046, 3426, 33191, 62887, 52315, 94832, 393, 56058, 6668, 28611, 55297, 6165, 13523, 72462, 55002, 97141, 34778, 36537, 62877, 6249, 88711, 11429, 16226, 58628, 89386, 65269, 15225, 62809, 19548, 80431, 26372, 68255, 54606, 70349, 64550, 71408, 99571, 44183, 13482, 99324, 86152, 92904, 7398, 81980, 39304, 29958, 35988, 92572, 53955, 17066, 25600, 73512, 78446, 69833, 66764, 54238, 36673, 91151, 35004, 28102, 48194, 61676, 44355, 79395, 96890, 90987, 70093, 7624, 42731, 90454, 84550, 41336, 64715, 43260, 16768, 91534, 29495, 83266, 92134, 73804, 89754, 29655, 26137, 74394, 40353, 42945, 2629, 80659, 11085, 29428, 89220, 44706, 78793, 67952, 3032, 43233, 18277, 32876, 89287, 5377, 10142, 95018, 39320, 32631, 69420, 47417, 10266, 52341, 94379, 90611, 12303, 43100, 1044, 42183, 46185, 94918, 79451, 53106, 88999, 81349, 69172, 73983, 70224, 39466, 82934, 71975, 7070, 66654, 22957, 28184, 35979, 2620, 70626, 69488, 62028, 52860, 13600, 48953, 85777, 47598, 72809, 66501, 76130, 81140, 58391, 17330, 9745, 18603, 28347, 43971, 38319, 20396, 57635, 15449, 19025, 38705, 90041, 79127, 70423, 84271, 49743, 13258, 3981, 78455, 55349, 48516, 53233, 60554, 13001, 4904, 92293, 78, 14566, 18295, 66595, 72225, 74479, 46717, 91420, 81500, 13834, 46887, 15258, 92282, 55365, 45385, 86188, 7297, 57000, 49323, 38527, 57806, 31203, 79908, 18924, 44761, 14877, 22571, 84246, 63890, 99284, 15923, 2840, 27423, 82786, 52068, 29859, 32553, 43130, 32136, 60465, 61757, 64570, 86925, 25398, 57751, 71045, 74899, 34926, 19646, 49299, 14284, 85512, 23982, 49417, 65804, 20384, 68761, 33370, 60874, 83074, 96479, 70482, 51222, 71320, 55440, 86805, 44889, 31346, 70302, 21096, 49242, 2828, 28425, 30889, 67589, 24936, 66065, 80199, 70354, 32495, 60942, 74320, 6337, 11756, 12399, 62774, 67958, 1595, 40896, 36448, 54469, 77984, 73619, 41723, 83428, 65745, 72591, 91604, 91560, 26309, 36495, 19856, 74302, 22959, 81533, 95819, 44056, 33878, 33067, 50367, 74118, 1766, 17074, 29612, 9236, 70459, 26007, 56259, 31435, 18245, 60360, 93262, 10823, 10113, 87464, 3967, 50152, 89446, 77465, 16932, 70583, 9722, 50027, 37444, 86739, 52059, 98181, 29505, 92974, 45577, 70172, 11611, 39183, 92456, 2871, 81537, 13506, 48842, 33410, 7635, 41367, 17350, 13539, 57055, 76874, 97606, 66092, 52013, 92781, 50309, 67823, 93881, 33372, 477, 15846, 73756, 86908, 71434, 30235, 4943, 21991, 87897, 65912, 53798, 86722, 52239, 64747, 87725, 24465, 2081, 98801, 64023, 51635, 70604, 31914, 10108]
efficiency = [85340554, 64615150, 52138061, 15637635, 47579750, 55726454, 2437874, 34927889, 17061584, 38539937, 34617517, 38557657, 56472622, 36732050, 45084193, 28919126, 65951443, 96124045, 12264446, 17377187, 20079421, 98001151, 13859996, 20899422, 13281162, 87195934, 25157099, 11967124, 82126748, 73765523, 71737521, 46533628, 87454907, 98585727, 91142944, 90146822, 15924482, 91879339, 24030573, 94511177, 28752098, 86472701, 52306941, 89751613, 39493269, 68158232, 52758668, 81350878, 14204219, 51856957, 94272953, 22430927, 34575768, 99747536, 38734238, 85048717, 28806472, 83692369, 65226377, 1149160, 97882637, 46557257, 35907764, 72549511, 59089521, 13523596, 68184457, 36284107, 33064450, 19909434, 34402173, 54722966, 84560664, 7842329, 81736015, 19978947, 36260559, 64444234, 41043386, 65944722, 66942187, 80397320, 32435395, 23643634, 24320745, 77919701, 60547448, 20056095, 67638547, 70931586, 18128433, 28612643, 83556934, 64479131, 15892331, 18806198, 34422747, 11815021, 72319939, 6715049, 23096679, 15587710, 75599525, 67513770, 88570890, 56675389, 568633, 40977289, 29563666, 99730571, 37604126, 83973651, 36114537, 96471047, 50905636, 16328441, 46576671, 15220369, 19230588, 77042078, 46573777, 12323886, 13852572, 42549703, 36149885, 6679549, 4183564, 18660933, 49936672, 85681662, 32488878, 91220299, 36726426, 69154076, 15060854, 86059463, 16898002, 36383718, 12223613, 77395850, 97358092, 63832019, 56199793, 52851012, 29446367, 40623874, 17867592, 80542907, 14746298, 32290302, 58332672, 73277085, 33609748, 36364197, 35130804, 16921265, 95143294, 99980902, 9271061, 73041146, 73115472, 97061302, 91884013, 4082053, 41356235, 91591832, 20907469, 77750089, 90814192, 64970975, 49001704, 21443671, 51235544, 54444089, 80665562, 36206014, 89507025, 85747958, 1098547, 1301694, 17794236, 75418789, 61676913, 57975871, 91167299, 37052520, 54818669, 81306298, 7150355, 63184857, 86715795, 93598706, 5645945, 78838329, 71194985, 47820220, 36360027, 87894136, 63607653, 32906622, 32186972, 75478220, 21294878, 5446358, 42103908, 97613499, 34022961, 83989889, 82805943, 55691672, 48149835, 45799918, 93850445, 85219015, 69658436, 7520384, 90333263, 68859521, 72884779, 84007513, 45766176, 95351861, 78219542, 64458866, 51437420, 23449366, 96179296, 13381037, 45044834, 88129442, 90838226, 99721903, 49600144, 87433251, 97072946, 57980878, 53533810, 16161191, 65535524, 16806050, 1602872, 55648957, 3519702, 10010758, 61578716, 89552944, 38722273, 20708273, 14191528, 2521559, 53223702, 94580881, 30650848, 93349486, 714578, 33483883, 21327854, 24032050, 88906270, 10208241, 74874240, 23569624, 78564717, 68869569, 57368037, 5429861, 97257498, 93993462, 92692712, 87718896, 10364402, 53440548, 15984451, 86421208, 51940559, 75156901, 86092129, 6037049, 32103948, 2798584, 62603087, 97031016, 22373843, 17877988, 94962356, 71764646, 60221548, 56050424, 22497289, 53080973, 52222655, 66490664, 48317164, 34823147, 37512283, 96765366, 11229123, 48388659, 19154408, 34226818, 46889453, 37464701, 62781874, 20002781, 33920024, 26374280, 77758473, 83003806, 72881842, 96114639, 77525791, 74345113, 52521823, 26284857, 83940450, 20546147, 7720856, 54410190, 56002897, 18448857, 80115109, 90286695, 73329803, 32375774, 18713584, 27167244, 96490146, 47897142, 23931473, 39975573, 19300785, 66051547, 39160576, 69026120, 28029378, 62203576, 38962842, 79536719, 82568725, 59538046, 82994865, 6987977, 21461666, 84448620, 15101873, 85017284, 33004033, 27900112, 68145202, 16316292, 28477627, 88698230, 17979105, 77624625, 97316974, 96329487, 27050784, 50741007, 64697058, 82353560, 35924768, 85689106, 90136859, 74406074, 31288485, 36734043, 56531412, 36504511, 13117351, 17394621, 75096551, 60925550, 6019185, 28767929, 97995501, 45130696, 12620166, 91015298]
k = 10

let label = 'maxPerformance'
console.time(label);
console.log(maxPerformance2(n, speed, efficiency, k));
console.timeLog(label, '2');
console.log(maxPerformance(n, speed, efficiency, k));
console.timeEnd(label);
